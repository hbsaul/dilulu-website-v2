(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{893:function(e,t,s){Promise.resolve().then(s.bind(s,5594))},5594:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var r=s(7437),n=s(2265),a=s(3779);let l=(0,n.createContext)({content:null,loading:!0,getPageContent:async()=>null,updateContent:async()=>({success:!1,message:"Not implemented"}),publishContent:async()=>({success:!1,message:"Not implemented"}),getContentHistory:async()=>[],revertToVersion:async()=>({success:!1,message:"Not implemented"})}),c=()=>(0,n.useContext)(l);var i=s(4126),o=s(1396),d=s.n(o);function m(){let{user:e,isAdmin:t,isEditor:s,loading:l}=(0,a.a)(),{getPageContent:o,updateContent:m,publishContent:x,getContentHistory:h,revertToVersion:u}=c(),{t:g,language:p,setLanguage:y}=(0,i.useLanguage)(),[b,f]=(0,n.useState)(""),[j,v]=(0,n.useState)(null),[N,w]=(0,n.useState)(null),[k,C]=(0,n.useState)(""),[E,S]=(0,n.useState)([]),[L,P]=(0,n.useState)(!1),[I,_]=(0,n.useState)(""),[D,F]=(0,n.useState)(""),[H,A]=(0,n.useState)(!1),[T,B]=(0,n.useState)(p);(0,n.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("id");e&&(f(e),G(e,T))},[]);let G=async(e,t)=>{P(!0);try{let s=await o(e,t);v(s)}catch(e){console.error("Error fetching page content:",e),_("Failed to load page content. Please try again.")}finally{P(!1)}},M=async()=>{P(!0);try{let e=await h(b,T);S(e),A(!0)}catch(e){console.error("Error fetching content history:",e),_("Failed to load content history. Please try again.")}finally{P(!1)}},O=e=>{w(e),C(e.content)},U=async()=>{P(!0),_(""),F("");try{let e=await m(b,(null==N?void 0:N.sectionId)||"",k,T);e.success?(F(g("cms.contentUpdated")),G(b,T),w(null)):_(e.message||g("cms.updateError"))}catch(e){console.error("Error updating content:",e),_(g("cms.updateErrorGeneric"))}finally{P(!1)}},z=async()=>{P(!0),_(""),F("");try{let e=await x(b,T);e.success?F(g("cms.contentPublished")):_(e.message||g("cms.publishError"))}catch(e){console.error("Error publishing content:",e),_(g("cms.publishErrorGeneric"))}finally{P(!1)}},R=async e=>{P(!0),_(""),F("");try{let t=await u(b,e,T);t.success?(F(g("cms.revertSuccess")),G(b,T),A(!1)):_(t.message||g("cms.revertError"))}catch(e){console.error("Error reverting content:",e),_(g("cms.revertErrorGeneric"))}finally{P(!1)}},V=e=>{B(e),G(b,e)};return l?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex justify-center items-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"spinner-border text-earth-green",role:"status",children:(0,r.jsx)("span",{className:"sr-only",children:g("common.loading")})}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:g("cms.loadingEditor")})]})}):t||s?b?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:g("cms.editor")}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center mr-4",children:[(0,r.jsxs)("span",{className:"mr-2",children:[g("common.language"),":"]}),(0,r.jsxs)("select",{value:T,onChange:e=>V(e.target.value),className:"border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-earth-green",children:[(0,r.jsx)("option",{value:"en",children:"English"}),(0,r.jsx)("option",{value:"fr",children:"Fran\xe7ais"})]})]}),(0,r.jsx)(d(),{href:"/admin",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:g("cms.backToDashboard")}),(0,r.jsx)("button",{onClick:M,className:"px-4 py-2 border border-blue-500 text-blue-500 rounded-md hover:bg-blue-50",children:g("cms.history")}),(0,r.jsx)("button",{onClick:z,disabled:L,className:"px-4 py-2 bg-earth-green text-white rounded-md hover:bg-earth-green-dark",children:g("cms.publish")})]})]}),I&&(0,r.jsx)("div",{className:"mb-6 bg-red-50 border-l-4 border-red-400 p-4",children:(0,r.jsx)("div",{className:"text-red-700",children:I})}),D&&(0,r.jsx)("div",{className:"mb-6 bg-green-50 border-l-4 border-green-400 p-4",children:(0,r.jsx)("div",{className:"text-green-700",children:D})}),L?(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[(0,r.jsx)("div",{className:"spinner-border text-earth-green",role:"status",children:(0,r.jsx)("span",{className:"sr-only",children:g("common.loading")})}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:g("cms.loadingContent")})]}):H?(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:g("cms.contentHistory")}),(0,r.jsx)("button",{onClick:()=>A(!1),className:"text-gray-500 hover:text-gray-700",children:g("common.close")})]}),E.length>0?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:g("cms.version")}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:g("cms.editedBy")}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:g("cms.date")}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:g("cms.actions")})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(e=>{var t;return(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["v",e.version]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(null===(t=e.editedBy)||void 0===t?void 0:t.name)||g("cms.unknown")}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.editedAt).toLocaleString()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsx)("button",{onClick:()=>R(e.version),className:"text-earth-green hover:text-earth-green-dark",children:g("cms.revert")})})]},e.version)})})]})}):(0,r.jsx)("p",{className:"text-gray-500",children:g("cms.noHistory")})]}):j?(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:j.title}),(0,r.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat("published"===j.publishStatus?"bg-green-100 text-green-800":"draft"===j.publishStatus?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:j.publishStatus}),(0,r.jsxs)("span",{className:"ml-4 text-sm text-gray-500",children:[g("cms.lastEdited"),": ",new Date(j.lastEditedAt).toLocaleString()]}),(0,r.jsxs)("span",{className:"ml-4 text-sm text-gray-500",children:[g("common.language"),": ","en"===T?"English":"Fran\xe7ais"]})]}),(0,r.jsx)("div",{className:"space-y-8",children:j.sections.map(e=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:e.title}),(0,r.jsx)("button",{onClick:()=>O(e),className:"text-earth-green hover:text-earth-green-dark",children:g("common.edit")})]}),N&&N.sectionId===e.sectionId?(0,r.jsxs)("div",{children:[(0,r.jsx)("textarea",{value:k,onChange:e=>C(e.target.value),rows:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-earth-green"}),(0,r.jsxs)("div",{className:"mt-2 flex justify-end space-x-2",children:[(0,r.jsx)("button",{onClick:()=>w(null),className:"px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:g("common.cancel")}),(0,r.jsx)("button",{onClick:U,disabled:L,className:"px-3 py-1 bg-earth-green text-white rounded-md hover:bg-earth-green-dark",children:g("common.save")})]})]}):(0,r.jsx)("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:e.content}})]},e.sectionId))})]}):(0,r.jsx)("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:g("cms.noContent")})})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:g("cms.editor")}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:g("cms.selectPage")}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:g("cms.selectPageInstructions")}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("input",{type:"text",placeholder:g("cms.enterPageId"),className:"flex-1 px-4 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-earth-green",value:b,onChange:e=>f(e.target.value)}),(0,r.jsx)("button",{onClick:()=>G(b,T),className:"px-4 py-2 bg-earth-green text-white rounded-r-md hover:bg-earth-green-dark",children:g("cms.loadPage")})]}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(d(),{href:"/admin",className:"text-earth-green hover:text-earth-green-dark",children:g("cms.returnToDashboard")})})]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center items-center p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-red-500 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsx)("h2",{className:"mt-4 text-2xl font-bold text-gray-900",children:g("cms.accessDenied")}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:g("cms.noPermission")}),(0,r.jsx)(d(),{href:"/",className:"mt-4 inline-block px-4 py-2 bg-earth-green text-white rounded-md hover:bg-earth-green-dark",children:g("common.returnHome")})]})})}},3779:function(e,t,s){"use strict";s.d(t,{a:function(){return a}}),s(7437);var r=s(2265);let n=(0,r.createContext)({user:null,loading:!0,login:async()=>({success:!1,message:"Not implemented"}),register:async()=>({success:!1,message:"Not implemented"}),logout:()=>{},isAuthenticated:!1,isAdmin:!1,isEditor:!1}),a=()=>(0,r.useContext)(n)},4126:function(e,t,s){"use strict";s.r(t),s.d(t,{LanguageProvider:function(){return c},useLanguage:function(){return l}});var r=s(7437),n=s(2265);let a=(0,n.createContext)({language:"en",setLanguage:()=>{},t:e=>e}),l=()=>(0,n.useContext)(a),c=e=>{let{children:t}=e,[l,c]=(0,n.useState)("en"),[i,o]=(0,n.useState)({en:{},fr:{}}),[d,m]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=localStorage.getItem("dilulu-language");e&&("en"===e||"fr"===e)&&c(e),(async()=>{try{let e=await s.e(423).then(s.t.bind(s,5048,19)),t=await s.e(148).then(s.t.bind(s,5148,19));o({en:e.default,fr:t.default})}catch(e){console.error("Failed to load translations:",e),o({en:{},fr:{}})}finally{m(!0)}})()},[]),(0,r.jsx)(a.Provider,{value:{language:l,setLanguage:e=>{c(e),localStorage.setItem("dilulu-language",e),document.documentElement.lang=e},t:e=>{if(!d)return e;let t=e.split(".");if(1===t.length){var s,r;return(null===(s=i[l])||void 0===s?void 0:s[e])||(null===(r=i.en)||void 0===r?void 0:r[e])||e}let n=i[l];for(let s of t){if(!n||"object"!=typeof n)return e;n=n[s]}return"string"!=typeof n&&(n=e),n}},children:t})}}},function(e){e.O(0,[176,971,938,744],function(){return e(e.s=893)}),_N_E=e.O()}]);