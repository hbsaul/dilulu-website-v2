(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[338],{8145:function(e,s,r){Promise.resolve().then(r.bind(r,4161))},4161:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return d}});var t=r(7437),a=r(2265),l=r(3779),n=r(1396),i=r.n(n);function d(){let{user:e,loading:s,logout:r}=(0,l.a)(),[n,d]=(0,a.useState)("profile"),[o,c]=(0,a.useState)(null),[m,x]=(0,a.useState)([]),[h,u]=(0,a.useState)(!0),[g,p]=(0,a.useState)(""),[w,f]=(0,a.useState)(""),[y,j]=(0,a.useState)({name:"",email:"",currentPassword:"",newPassword:"",confirmPassword:""});(0,a.useEffect)(()=>{!s&&e&&(b(),j({...y,name:e.name,email:e.email}))},[s,e]);let b=async()=>{u(!0);try{let e=await fetch("/api/user/profile"),s=await e.json(),r=await fetch("/api/user/activity"),t=await r.json();s.success&&c(s.profile),t.success&&x(t.activity)}catch(e){console.error("Error fetching user data:",e),p("Failed to load user data. Please try again.")}finally{u(!1)}},v=e=>{let{name:s,value:r}=e.target;j(e=>({...e,[s]:r}))},N=async s=>{s.preventDefault(),u(!0),p(""),f("");try{let s=await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:y.name})}),r=await s.json();r.success?(f("Profile updated successfully!"),e&&(e.name=y.name)):p(r.message||"Failed to update profile. Please try again.")}catch(e){console.error("Error updating profile:",e),p("An error occurred while updating your profile. Please try again.")}finally{u(!1)}},k=async e=>{if(e.preventDefault(),u(!0),p(""),f(""),y.newPassword!==y.confirmPassword){p("New passwords do not match"),u(!1);return}try{let e=await fetch("/api/user/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:y.currentPassword,newPassword:y.newPassword})}),s=await e.json();s.success?(f("Password updated successfully!"),j({...y,currentPassword:"",newPassword:"",confirmPassword:""})):p(s.message||"Failed to update password. Please try again.")}catch(e){console.error("Error updating password:",e),p("An error occurred while updating your password. Please try again.")}finally{u(!1)}},P=async()=>{await r(),window.location.href="/"};return s?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex justify-center items-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"spinner-border text-earth-green",role:"status",children:(0,t.jsx)("span",{className:"sr-only",children:"Loading..."})}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading dashboard..."})]})}):e?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-earth-green shadow",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsx)("div",{className:"flex",children:(0,t.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,t.jsx)("h1",{className:"text-white text-xl font-bold",children:"User Dashboard"})})}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("span",{className:"text-white mr-4",children:["Welcome, ",e.name]}),(0,t.jsx)(i(),{href:"/",className:"text-white hover:text-gray-200",children:"Back to Site"})]})]})})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[g&&(0,t.jsx)("div",{className:"mb-4 bg-red-50 border-l-4 border-red-400 p-4",children:(0,t.jsx)("div",{className:"text-red-700",children:g})}),w&&(0,t.jsx)("div",{className:"mb-4 bg-green-50 border-l-4 border-green-400 p-4",children:(0,t.jsx)("div",{className:"text-green-700",children:w})}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,t.jsx)("div",{className:"w-full md:w-64 mb-6 md:mb-0",children:(0,t.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:(0,t.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,t.jsxs)("nav",{className:"space-y-1",children:[(0,t.jsxs)("button",{onClick:()=>d("profile"),className:"w-full text-left px-3 py-2 rounded-md flex items-center ".concat("profile"===n?"bg-earth-green text-white":"text-gray-700 hover:bg-gray-50"),children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Profile"]}),(0,t.jsxs)("button",{onClick:()=>d("activity"),className:"w-full text-left px-3 py-2 rounded-md flex items-center ".concat("activity"===n?"bg-earth-green text-white":"text-gray-700 hover:bg-gray-50"),children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Activity"]}),(0,t.jsxs)("button",{onClick:()=>d("security"),className:"w-full text-left px-3 py-2 rounded-md flex items-center ".concat("security"===n?"bg-earth-green text-white":"text-gray-700 hover:bg-gray-50"),children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Security"]}),(0,t.jsxs)("button",{onClick:P,className:"w-full text-left px-3 py-2 rounded-md flex items-center text-red-600 hover:bg-red-50",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})})})}),(0,t.jsx)("div",{className:"w-full md:flex-1 md:ml-6",children:(0,t.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:h&&!s?(0,t.jsxs)("div",{className:"p-6 text-center",children:[(0,t.jsx)("div",{className:"spinner-border text-earth-green",role:"status",children:(0,t.jsx)("span",{className:"sr-only",children:"Loading..."})}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading data..."})]}):(0,t.jsxs)(t.Fragment,{children:["profile"===n&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Profile Information"}),(0,t.jsx)("form",{onSubmit:N,children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:y.name,onChange:v,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-earth-green focus:border-earth-green"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:y.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Email address cannot be changed."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700",children:"Account Type"}),(0,t.jsx)("input",{type:"text",id:"role",value:e.role.charAt(0).toUpperCase()+e.role.slice(1),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"joinDate",className:"block text-sm font-medium text-gray-700",children:"Member Since"}),(0,t.jsx)("input",{type:"text",id:"joinDate",value:new Date(e.createdAt).toLocaleDateString(),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50"})]}),(0,t.jsx)("div",{className:"pt-4",children:(0,t.jsx)("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-earth-green text-white rounded-md hover:bg-earth-green-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-earth-green",children:h?"Saving...":"Save Changes"})})]})})]}),"activity"===n&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Activity History"}),m&&m.length>0?(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activity"}),(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Details"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map((e,s)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.type}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.date).toLocaleString()}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.details})]},s))})]})}):(0,t.jsx)("p",{className:"text-gray-500",children:"No activity history available."})]}),"security"===n&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Security Settings"}),(0,t.jsxs)("form",{onSubmit:k,className:"mb-8",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Change Password"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),(0,t.jsx)("input",{type:"password",id:"currentPassword",name:"currentPassword",value:y.currentPassword,onChange:v,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-earth-green focus:border-earth-green"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,t.jsx)("input",{type:"password",id:"newPassword",name:"newPassword",value:y.newPassword,onChange:v,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-earth-green focus:border-earth-green"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,t.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:y.confirmPassword,onChange:v,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-earth-green focus:border-earth-green"})]}),(0,t.jsx)("div",{className:"pt-4",children:(0,t.jsx)("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-earth-green text-white rounded-md hover:bg-earth-green-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-earth-green",children:h?"Updating...":"Update Password"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account Security"}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Password protected account"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-yellow-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Two-factor authentication not enabled"})]})]})]})]})]})})})]})]})]}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center items-center p-4",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-red-500 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,t.jsx)("h2",{className:"mt-4 text-2xl font-bold text-gray-900",children:"Authentication Required"}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Please log in to access your dashboard."}),(0,t.jsx)(i(),{href:"/login",className:"mt-4 inline-block px-4 py-2 bg-earth-green text-white rounded-md hover:bg-earth-green-dark",children:"Log in"})]})})}},3779:function(e,s,r){"use strict";r.d(s,{a:function(){return l}}),r(7437);var t=r(2265);let a=(0,t.createContext)({user:null,loading:!0,login:async()=>({success:!1,message:"Not implemented"}),register:async()=>({success:!1,message:"Not implemented"}),logout:()=>{},isAuthenticated:!1,isAdmin:!1,isEditor:!1}),l=()=>(0,t.useContext)(a)}},function(e){e.O(0,[176,971,938,744],function(){return e(e.s=8145)}),_N_E=e.O()}]);